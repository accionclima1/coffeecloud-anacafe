<script type="text/ng-template" id="/homeinternal.html">
  <style>
    #nuevoLote {
      color:#fff;
      border-color:#FE8515;
      background-color:#FE8515;
    }
    </style>
  <div class="home-wrap profile-wrap">
    <div class="container">
      <div class="row">
         <div class="col-lg-12 col-md-12 col-xs-12">
           <div class="page-header">
             <h2>
               <a class="back-homeint" style="position: fixed;left: 20px;color: #FFF;" href="#/home">
   							<i style="font-size: 20px;" class="fa fa-chevron-left"></i>
   					   </a>
               Información de Unidad</span>
             </h2>
           </div>
         </div>
       </div>


       <div class="row">
         <div class="col-xs-12 grup-lotes">
           <h4 class="titleUnit" style="padding-left:0">Nombre: {{unidadseleccionada.nombre}}</h4>
           <div align="right">
             <button type="button" id="nuevoLote" class="btn btn-default" ng-click="prependItem()" style="margin-bottom:20px"><span class="glyphicon glyphicon-plus"></span> Agregar nuevo lote</button>
           </div>

           <form name="updateunitFormlote" ng-submit="updateUnitForm($event,editUnit._id)" id="updateunitFormlote" >
             <div class="panel-group" id="accordion" role="tablist" aria-multiselectable="false">
               <div class="panel panel-default" ng-repeat="lote in unidadseleccionada.lote">

                 <div class="clearfix"></div>

                 <div class="clearfix"></div>

                 <div class="panel-heading" role="tab" id="{{ 'heading-' + $index }}">
                   <div class="col-md-8 col-xs-7">
                     <h4 class="panel-title">
                       <a role="button" id="{{ 'opLote-' + $index }}" data-toggle="collapse" data-parent="#accordion" data-target="{{ '#collapse-' + $index }}" aria-expanded="false" aria-controls="{{ 'collapse-' + $index }}" class="tituloLote collapse">
                         <span ng-bind="lote.nombre"></span>
                       </a>
                     </h4>
                   </div>
                   <div class="col-md-2 col-xs-3 areaCalculo">
                     <button id="{{ 'calculo-' + $index }}" type="button" class="btn btn-danger" style="background-color:#FE8515;"><a href="#/homeloteinternal/{{unidadseleccionada._id}}/{{unitIndex}}/{{$index}}" class="lnkLote"><i class="fa fa-leaf" style="font-size:16px;"></i></a></button>
                   </div>
                   <div class="col-md-2 col-xs-2 areaBorrarLote" style="padding-right: 14%;">
                     <button id="{{ 'borrarLote-' + $index }}" type="button" class="btn btn-danger" ng-click="eliminarLote($index)"><i class="fa fa-trash" style="font-size:16px;"></i></button>
                   </div>
                 </div>

                 <div id="{{ 'collapse-' + $index }}" class="panel-collapse collapse in" role="tabpanel" aria-labelledby="{{ 'collapse-' + $index }}">
                   <div class="col-xs-12" style="background-color: #fff;border-radius: 5px;">
                     <div class="{{'collapse map'+$index}}" >
                       <div align="left" style="margin-bottom:10px;"><a ng-click="toggle=!toggle;mapInit($index);" style="color:#00abff"><- Regresar a formulario</a></div>
                       <i class="fa fa-spinner fa-spin"></i>
                       <div id="{{ 'map-canvas-lote' + $index }}"
                       style="height:400px;width:100%;margin-top: 5%;padding-bottom: 5%;" ></div>
                     </div>
                   </div>

                   <div  class="{{'panel-body cuerpoMapa'+$index}}">
                     <div class="row">
                       <div class="col-xs-12">
                         <div class="form-group">
                           <input type="text"
                           class="form-control"
                           placeholder="Nombre del lote"
                           ng-model="lote.nombre" required></input>
                         </div>
                       </div>

                       <div class="col-xs-12">
                         <div class="form-group">
                           <input type="text"
                           class="form-control {{ 'latLongLoteId' + $index }}"
                           placeholder="Geo Referencia"
                           ng-model="lote.georeferenciacion" id="{{ 'latlongid' + $index }}"></input>
                           <span class="input-group-btn">
                             <button style="margin-top: 0px;" class="btn btn-default" type="button" ng-click="toggle = !toggle; mapInit($index)">
                               <i class="fa fa-map-marker" aria-hidden="true" ng-show="!toggle"></i>
                               <i class="fa fa-times" aria-hidden="true" ng-show="toggle"></i>
                             </button>
                           </span>
                           <span class="cargandoUbicacionLote" id="{{'messageLocationLote' + $index}}" style="display:none;">(Cargando Ubicación...)</span>
                         </div>
                       </div>
                       <div class="col-xs-12">
                         <div class="form-group">
                           <input type="text"
                           class="form-control"
                           id="{{ 'altitudLoteId' + $index }}"
                           placeholder="Altitud"
                           ng-model="lote.altitud"
                           required></input>
                           <span class="cargandoAltitudLote" id="{{'messageAltitudLote' + $index}}" style="display:none;">(Cargando Altitud...)</span>
                         </div>

                       </div>
                       <div class="col-xs-12">
                         <div class="form-group">
                           <input type="text"
                           class="form-control"
                           placeholder="Tamaño del lote (manzanas)"
                           ng-model="lote.tamano"
                           required></input>
                         </div>
                       </div>
                       <div class="col-xs-12">
                         <div class="form-group">
                           <input type="text"
                           class="form-control"
                           placeholder="Edad del lote"
                           ng-model="lote.edad"
                           required></input>
                         </div>
                       </div>
                       <div class="col-xs-12">
                         <div class="form-group">
                           <select class="form-control"
                           id="selCoffeProducessOptions"
                           multiple="true"
                           ng-model="lote.variedad"
                           data-error="Campo requerido"
                           required>
                             <option ng-repeat="option in variedades" value="{{option.name}}" ng-selected="(lote.variedad.indexOf(option.name)>=0)">{{option.name}}</option>
                           </select>
                         </div>
                       </div>

                       <div class="col-xs-12">
                         <div class="form-group">
                           <input type="text"
                           class="form-control"
                           placeholder="Distanciamiento Ej: 2x1"
                           ng-model="lote.distanciamiento"
                           required></input>
                         </div>
                       </div>

                       <div class="col-xs-12">
                         <div class="form-group">
                           <p>¿Tiene sombra?</p>
                           <div class="radio" style="display: inline;">
                             <label>
                               <input type="radio" id="optionsRadios1A" ng-value="true" ng-model="lote.sombra">
                               Si
                             </label>
                           </div>
                           <div class="radio" style="display: inline;">
                             <label>
                               <input type="radio" id="optionsRadios2A" ng-value="false" ng-model="lote.sombra" checked>
                               No
                             </label>
                           </div>
                         </div>
                         <div class="form-group" ng-if="lote.sombra">
                             <label>¿Qué porcentaje?</label>
                             <input type="number"
                             id="porcentajeSombra"
                             class="form-control"
                             placeholder="Porcentaje 0-100%"
                             ng-model="lote.porcentajeDeSombra"
                             min="0" max="100"
                             required></input>
                         </div>
                       </div>

                       <div class="col-xs-12">
                         <div class="form-group">
                           <p>¿Tiene cobertura de suelo?</p>
                           <div class="radio" style="display: inline;">
                             <label>
                               <input type="radio" id="optionsRadios1" name="cobertura" ng-value="true" ng-model="lote.cobertura">
                               Si
                             </label>
                           </div>
                           <div class="radio" style="display: inline;">
                             <label>
                               <input type="radio" id="optionsRadios2" name="cobertura" ng-value="false" ng-model="lote.cobertura" checked>
                               No
                             </label>
                           </div>
                         </div>
                       </div>

                     </div>
                   </div>
                 </div>
               </div>
             </div>
           </form>
         </div>
       </div>


       <div class="row">
         <div class="col-md-12 col-sm-12 col-xs-12">
           <button type="button" class="btn btn-primary" form="updateunitFormlote" ng-click="updateUnitForm()">Salvar cambios a lotes</button>
         </div>
       </div>

      <div class="row">
        <div class="col-xs-12 grup-lotes">
          <h4 class="titleUnit" style="text-align:center;">VULNERABILIDAD</h4>
        </div>
      </div>

<div class="panel panel-default">
  <div class="panel-heading"><div class="col-md-10 col-xs-6" align="left">Análisis cambio climático</div><div class="col-md-2 col-xs-6" align="right"><a class=" btn btn-default btn-sm" href="#/vulnerability/{{unidadseleccionada._id}}/{{unitIndex}}" style="color:#000">Evaluar</a></div></div>
  <div class="panel-body">
<h6 ng-show="encuestaHistoryByUnidad.length == 0" style="color:#666666">¡No hay encuestas todavía!</h6>
<div class="panel-group" id="accordion" role="tablist" aria-multiselectable="false">
	<div id="datagUnit" class="ct-chart ct-chart-line" style="width: 100%; height: 250px; display: none"></div>

	<div class="panel panel-default" ng-repeat="encuesta in encuestaHistoryByUnidad">
		<div class="panel-heading" role="tab" id="{{ 'heading-' + encuesta._id }}">

			<h5 class="panel-title" style="text-align: left;">
				<a style="text-decoration:none; " role="button" data-toggle="collapse" data-parent="#accordion" data-target="{{ '#collapse-' + encuesta._id }}" aria-expanded="false" aria-controls="{{ 'collapse-' + encuesta.id }}">
					<small> {{ encuesta.resumenVulne[0].fecha | date : "MMM d, y h:mm:ss a" }}</small>
					<span class="badge" style="margin-left:5px;" id="cantrecomienda">{{encuesta.resumenVulne[0].valor}}</span>
				</a>
			</h5>

		</div>
		<div id="{{ 'collapse-' +  encuesta._id}}" class="panel-collapse collapse" role="tabpanel" aria-labelledby="{{ 'collapse-' + encuesta._id }}" style="color:#666666;">
			<div class="panel-body" style="text-align: left;">
				Resultado:<strong> {{encuesta.resumenVulne[0].titulo}}</strong>

				<p>{{encuesta.resumenVulne[0].textoData}}</p>

			</div>
		</div>
	</div>


  <div class="panel panel-default" ng-repeat="encuesta in encuestaHistoryByUnidadOffline">
		<div class="panel-heading" role="tab" id="{{ 'heading-' + encuesta._id }}">

			<h5 class="panel-title" style="text-align: left;">
				<a style="text-decoration:none; " role="button" data-toggle="collapse" data-parent="#accordion" data-target="{{ '#collapse-' + encuesta._id }}" aria-expanded="false" aria-controls="{{ 'collapse-' + encuesta.id }}">
					<small> {{ encuesta.resumenVulne.fecha | date : "MMM d, y h:mm:ss a" }}</small>
					<span class="badge" style="margin-left:5px;" id="cantrecomienda">{{encuesta.resumenVulne.valor}}</span><small>  (Offline)</small>
				</a>
			</h5>

		</div>
		<div id="{{ 'collapse-' +  encuesta._id}}" class="panel-collapse collapse" role="tabpanel" aria-labelledby="{{ 'collapse-' + encuesta._id }}" style="color:#666666;">
			<div class="panel-body" style="text-align: left;">
				Resultado:<strong> {{encuesta.resumenVulne.titulo}}</strong>

				<p>{{encuesta.resumenVulne.textoData}}</p>

			</div>
		</div>
	</div>

  <!-- <div class="panel panel-default" ng-repeat="encuesta in resumenDataHistorial">
		<div class="panel-heading" role="tab" id="{{ 'heading-' + encuesta.id }}">

			<h5 class="panel-title" style="text-align: left;">
				<a style="text-decoration:none; " role="button" data-toggle="collapse" data-parent="#accordion" data-target="{{ '#collapse-' + encuesta.id }}" aria-expanded="false" aria-controls="{{ 'collapse-' + encuesta.id }}">
					<small> {{ encuesta.fecha | date : "MMM d, y h:mm:ss a" }}</small>
					<span class="badge" style="margin-left:5px;" id="cantrecomienda">{{encuesta.valor}}</span>
				</a>
			</h5>

		</div>
	</div> -->

</div>
  </div>
</div>


    </div>
  </div>
</script>
